import React, { createContext, useState, useContext, ReactNode } from 'react';

// 1. Define translations
const translations = {
  en: {
    errors: {
        generic: 'An unexpected error occurred. Please try again later.',
        loadData: 'Failed to load data. Please refresh the page or try again later.',
        saveData: 'Failed to save changes. Please check your input and try again.',
        actionFailed: 'The requested action could not be completed. Please try again.',
        loadDashboard: "We couldn't retrieve the necessary data from the server. This could be a temporary issue. Please try again.",
        loadDashboardTitle: 'Could Not Load Dashboard',
        retryButton: 'Try Again',
        incorrectCredentials: 'The email or password you entered is incorrect.',
        serverError: 'An unknown error occurred. Please try again later.',
        passwordRequired: 'Password is required for new users.',
        cannotDeleteSelf: 'You cannot delete your own user account while logged in.',
    },
    login: {
        title: 'AquaGuard',
        subtitle: 'Water Leakage Prevention System',
        emailLabel: 'Email Address',
        passwordLabel: 'Password',
        loginButton: 'Login',
        loading: 'Logging in...',
    },
    header: {
        welcome: 'Welcome, {{name}}',
        logout: 'Logout',
    },
    sidebar: {
        title: 'AquaGuard',
        overview: 'Overview',
        pipelineMap: 'Pipeline Map',
        forum: 'Community Forum',
        reports: 'Reports',
        management: 'Management',
        sensorManagement: 'Sensor Management',
        householdManagement: 'Household Management',
        pumpManagement: 'Pump Management',
        userManagement: 'User Management',
        mlTraining: 'ML Training',
        systemLogs: 'System Logs',
        copyright: '© 2025 AquaGuard Inc.',
    },
    dashboard: {
        reportsWip: 'Report generation feature coming soon.',
    },
    managementShared: {
        connectToLabel: 'Connect To (optional)',
        connectToDescription: 'Select one or more nodes to create a pipeline connection.',
    },
    statCard: {
        activeAlerts: 'Active Alerts',
        avgPressure: 'Avg. Pressure',
        avgFlowRate: 'Avg. Flow Rate',
        sensorsOnline: 'Sensors Online',
        totalHouseholds: 'Total Households',
        trendPeriod: 'vs last 12h',
    },
    healthScore: {
        title: 'System Health',
        operational: 'Operational',
        warning: 'Warning',
        critical: 'Critical',
    },
    aiSummary: {
        title: 'AI System Analysis',
        loading: 'Analyzing system data...',
        base: 'As an AI, my analysis of the current data indicates ',
        critical: 'a critical situation. There is at least one critical alert requiring immediate attention. ',
        multipleAlerts: 'a heightened state of alert. There are {{count}} active alerts that need investigation. ',
        noAlerts: 'that the system is operating under normal parameters. There are no active alerts. ',
        anomalies: "Review of the 24-hour history shows some anomalies. ",
        pressureDips: "I've detected {{count}} significant pressure drop(s). ",
        flowSpikes: "I've also noted {{count}} unusual flow rate spike(s). ",
        anomaliesConclusion: "These could be precursors to larger issues and warrant a closer look at the historical data chart.",
        stableHistory: "The 24-hour historical data also appears stable with no major anomalies detected.",
        error: "As an AI, I was unable to process the system data at this time.",
    },
    alertsTable: {
        title: 'Active Alerts',
        loading: 'Loading alerts...',
        noAlerts: 'No active alerts. System is normal.',
        sensorLabel: 'Sensor',
        affectedPipeline: 'Pipe',
        analyzeButton: 'Analyze',
        resolveButton: 'Resolve',
        falseAlertButton: 'False Alert',
        resolveConfirmTitle: 'Resolve Alert?',
        resolveConfirmMessage: 'Are you sure you want to mark this alert as resolved? This assumes the underlying issue has been addressed.',
        falseAlertConfirmTitle: 'Mark as False Alert?',
        falseAlertConfirmMessage: "This will resolve the alert and mark it as a false positive. This action is useful for improving the AI model's accuracy.",
        cancelButton: 'Cancel',
        confirmButton: 'Confirm',
        timeAgo: {
            year: '{{count}}y ago',
            years: '{{count}}y ago',
            month: '{{count}}mo ago',
            months: '{{count}}mo ago',
            day: '{{count}}d ago',
            days: '{{count}}d ago',
            hour: '{{count}}h ago',
            hours: '{{count}}h ago',
            minute: '{{count}}m ago',
            minutes: '{{count}}m ago',
            second: 'Just now',
        }
    },
    historyChart: {
        title: '24-Hour System History',
        loading: 'Loading historical data...',
        pressureLabel: 'Pressure (PSI)',
        flowRateLabel: 'Flow Rate (L/min)',
    },
    analysisModal: {
        title: 'AI-Powered Alert Analysis',
        alertDetails: 'Alert Details',
        messageLabel: 'Message',
        severityLabel: 'Severity',
        sensorLabel: 'Sensor ID',
        loading: 'Performing analysis... please wait.',
        summaryTitle: 'Analysis Summary',
        causesTitle: 'Potential Causes',
        actionsTitle: 'Suggested Actions',
        closeButton: 'Close',
    },
    pipelineMap: {
        title: 'System Pipeline Map',
        editMode: 'Edit Mode',
        viewMode: 'View Mode',
        creatingPipeline: 'Select a second node to complete the connection or press ESC to cancel.',
        editInstructionsPipelines: 'Click two nodes to create a pipeline, drag nodes to move, or click a pipeline to delete.',
        loading: 'Loading map data...',
        sensorTooltipTitle: 'Sensor',
        householdTooltipTitle: 'Household',
        pumpTooltipTitle: 'Pump',
        pipelineTooltipTitle: 'Pipeline',
        statusAlert: 'Alert Active',
        statusNormal: 'Normal',
        statusLeak: 'Leak Detected',
        pumpStatus: {
            Active: 'Active',
            Inactive: 'Inactive',
            Error: 'Error',
        },
        location: 'Location',
        description: 'Description',
        address: 'Address',
        id: 'ID',
        from: 'From',
        to: 'To',
        deletePipelineButton: 'Delete Pipeline',
        addConnectionButton: 'Add Connection',
    },
    sensorManagement: {
        title: 'Sensor Management',
        existingSensors: 'Existing Sensors',
        loading: 'Loading sensors...',
        connectedTo: 'Connected To',
        noConnections: 'No connections.',
        editSensorTitle: 'Edit Sensor',
        addSensorTitle: 'Add New Sensor',
        locationLabel: 'Location',
        locationPlaceholder: 'e.g., Maple Ave. & Oak St.',
        descriptionLabel: 'Description',
        descriptionPlaceholder: 'e.g., District A feeder line',
        saveButton: 'Save Changes',
        addButton: 'Add Sensor',
        cancelButton: 'Cancel',
        editButton: 'Edit',
        deleteButton: 'Delete',
        deleteConfirm: 'Are you sure you want to delete this sensor? All associated pipeline data will also be removed.',
    },
    householdManagement: {
        title: 'Household Management',
        existingHouseholds: 'Existing Households',
        loading: 'Loading households...',
        connectedTo: 'Connected To',
        noConnections: 'No connections.',
        editHouseholdTitle: 'Edit Household',
        addHouseholdTitle: 'Add New Household',
        addressLabel: 'Address',
        addressPlaceholder: 'e.g., 123 Aqua St, Brgy. Central',
        saveButton: 'Save Changes',
        addButton: 'Add Household',
        cancelButton: 'Cancel',
        editButton: 'Edit',
        deleteButton: 'Delete',
        deleteConfirm: 'Are you sure you want to delete this household? All associated pipeline data will also be removed.',
    },
    pumpManagement: {
        title: 'Pump Management',
        existingPumps: 'Existing Pumps',
        loading: 'Loading pumps...',
        connectedTo: 'Connected To',
        noConnections: 'No connections.',
        editPumpTitle: 'Edit Pump',
        addPumpTitle: 'Add New Pump',
        locationLabel: 'Location',
        locationPlaceholder: 'e.g., Brgy. West Booster',
        statusLabel: 'Status',
        saveButton: 'Save Changes',
        addButton: 'Add Pump',
        cancelButton: 'Cancel',
        editButton: 'Edit',
        deleteButton: 'Delete',
        deleteConfirm: 'Are you sure you want to delete this pump? All associated pipeline data will also be removed.',
    },
    userManagement: {
        title: 'User Management',
        existingUsers: 'Existing Users',
        loading: 'Loading users...',
        editUserTitle: 'Edit User',
        addUserTitle: 'Add New User',
        nameLabel: 'Full Name',
        namePlaceholder: 'e.g., Juan dela Cruz',
        emailLabel: 'Email Address',
        emailPlaceholder: 'e.g., user@example.com',
        roleLabel: 'Role',
        saveButton: 'Save Changes',
        addButton: 'Add User',
        cancelButton: 'Cancel',
        editButton: 'Edit',
        deleteButton: 'Delete',
        deleteConfirm: 'Are you sure you want to remove this user?',
    },
    forum: {
        title: 'Community Forum',
        announcements: 'Announcements',
        communityHub: 'Community Hub',
        adminDiscussions: 'Admin Discussions',
        newTopic: 'New Topic',
        editTopic: 'Edit Topic', 
        by: 'By',
        noTopics: 'No topics in this category yet.',
        loadingTopics: 'Loading topics...',
        loadingTopic: 'Loading topic...',
        backToTopics: 'Back to Topics',
        topicTitle: 'Topic Title',
        yourMessage: 'Your Message',
        createTopic: 'Create Topic',
        saveChanges: 'Save Changes', 
        cancel: 'Cancel',
        yourReply: 'Your Reply...',
        postReply: 'Post Reply',
        confirmDelete: 'Are you sure you want to delete this topic?', 
        general: 'General',
        alerts: 'Alerts',
        maintenance: 'Maintenance'
    },
    mlTraining: {
        title: 'Machine Learning Model',
        status: 'Model Status',
        statusNotTrained: 'Not Trained',
        statusTraining: 'Training',
        statusTrained: 'Trained',
        lastTrained: 'Last Trained',
        notTrained: 'N/A',
        startTrainingButton: 'Start Training Process',
        trainingInProgressButton: 'Training in Progress...',
        
        // ✅ ADDED MISSING KEYS
        trainingButton: 'Training...',
        trainingButtonLoading: 'Processing...',
        trainingInProgress: 'Training in Progress...',
        currentVersion: 'Current Version',
        nextTraining: 'Next Training Trigger',
        
        trainingLogTitle: 'Training Log',
        resultsTitle: 'Training Results',
        accuracy: 'Model Accuracy',
        confusionMatrixTitle: 'Confusion Matrix',
        predicted: 'Predicted',
        actual: 'Actual',
        leak: 'Leak',
        noLeak: 'No Leak',
        logs: {
            start: 'Training process initiated...',
            loadData: 'Loading historical sensor and alert data...',
            preprocess: 'Preprocessing data: cleaning and normalization...',
            featureSelection: 'Performing feature selection...',
            training: 'Training model with processed data (this may take a moment)...',
            evaluating: 'Evaluating model performance...',
            complete: 'Training complete!',
        }
    },
    logViewer: {
        title: 'System Activity Logs',
        searchPlaceholder: 'Search logs by action, details, or user...',
        loading: 'Loading logs...',
        noLogs: 'No logs found matching your criteria.',
        logEntry: 'Log Entry',
        logEntries: 'Log Entries',
        header: {
            timestamp: 'Timestamp',
            action: 'Action',
            details: 'Details',
        },
    },
  },
  fil: {
    errors: {
        generic: 'May hindi inaasahang error. Pakisubukang muli mamaya.',
        loadData: 'Nabigong i-load ang data. Paki-refresh ang pahina o subukang muli.',
        saveData: 'Nabigong i-save ang mga pagbabago. Paki-check ang iyong input at subukang muli.',
        actionFailed: 'Hindi makumpleto ang hinihiling na aksyon. Pakisubukang muli.',
        loadDashboard: "Hindi namin makuha ang kinakailangang data mula sa server. Maaaring pansamantala lamang ito. Pakisubukang muli.",
        loadDashboardTitle: 'Hindi Ma-load ang Dashboard',
        retryButton: 'Subukang Muli',
        incorrectCredentials: 'Mali ang email o password na iyong inilagay.',
        serverError: 'May hindi kilalang error na naganap. Pakisubukang muli mamaya.',
        passwordRequired: 'Kailangan ang password para sa mga bagong user.',
        cannotDeleteSelf: 'Hindi mo maaaring tanggalin ang sarili mong user account habang naka-login.',
    },
    login: {
        title: 'AquaGuard',
        subtitle: 'Sistema para sa Pag-iwas sa Pagtulo ng Tubig',
        emailLabel: 'Email Address',
        passwordLabel: 'Password',
        loginButton: 'Mag-login',
        loading: 'Nagla-login...',
    },
    header: {
        welcome: 'Maligayang pagdating, {{name}}',
        logout: 'Mag-logout',
    },
    sidebar: {
        title: 'AquaGuard',
        overview: 'Pangkalahatang-ideya',
        pipelineMap: 'Mapa ng Pipeline',
        forum: 'Forum ng Komunidad',
        reports: 'Mga Ulat',
        management: 'Pamamahala',
        sensorManagement: 'Pamamahala ng Sensor',
        householdManagement: 'Pamamahala ng Sambahayan',
        pumpManagement: 'Pamamahala ng Pump',
        userManagement: 'Pamamahala ng User',
        mlTraining: 'Pagsasanay sa ML',
        systemLogs: 'Mga Log ng Sistema',
        copyright: '© 2025 AquaGuard Inc.',
    },
    dashboard: {
        reportsWip: 'Malapit nang dumating ang feature sa pagbuo ng ulat.',
    },
    managementShared: {
        connectToLabel: 'Ikonekta Sa (opsyonal)',
        connectToDescription: 'Pumili ng isa o higit pang mga node para gumawa ng koneksyon ng pipeline.',
    },
    statCard: {
        activeAlerts: 'Mga Aktibong Alerto',
        avgPressure: 'Karaniwang Presyon',
        avgFlowRate: 'Karaniwang Bilis ng Daloy',
        sensorsOnline: 'Mga Sensor na Online',
        totalHouseholds: 'Kabuuang Sambahayan',
        trendPeriod: 'vs huling 12h',
    },
    healthScore: {
        title: 'Kalusugan ng Sistema',
        operational: 'Gumagana',
        warning: 'Babala',
        critical: 'Kritikal',
    },
    aiSummary: {
        title: 'Pagsusuri ng Sistema ng AI',
        loading: 'Sinusuri ang data ng sistema...',
        base: 'Bilang isang AI, ang aking pagsusuri sa kasalukuyang data ay nagpapahiwatig ',
        critical: 'ng isang kritikal na sitwasyon. Mayroong kahit isang kritikal na alerto na nangangailangan ng agarang pansin. ',
        multipleAlerts: 'ng isang mataas na estado ng alerto. Mayroong {{count}} na aktibong alerto na kailangang imbestigahan. ',
        noAlerts: 'na ang sistema ay gumagana sa ilalim ng normal na mga parameter. Walang mga aktibong alerto. ',
        anomalies: "Ang pagsusuri sa 24-oras na kasaysayan ay nagpapakita ng ilang mga anomalya. ",
        pressureDips: "Nakita ko ang {{count}} na makabuluhang pagbaba ng presyon. ",
        flowSpikes: "Napansin ko rin ang {{count}} na hindi pangkaraniwang pagtaas ng bilis ng daloy. ",
        anomaliesConclusion: "Maaaring ito ay mga paunang senyales ng mas malalaking isyu at nangangailangan ng mas malapit na pagsusuri sa historical data chart.",
        stableHistory: "Ang 24-oras na historical data ay mukhang matatag din na walang malalaking anomalya na nakita.",
        error: "Bilang isang AI, hindi ko maproseso ang data ng sistema sa oras na ito.",
    },
    alertsTable: {
        title: 'Mga Aktibong Alerto',
        loading: 'Nilo-load ang mga alerto...',
        noAlerts: 'Walang aktibong alerto. Normal ang sistema.',
        sensorLabel: 'Sensor',
        affectedPipeline: 'Apektadong Pipeline',
        analyzeButton: 'Suriin',
        resolveButton: 'Lutasin',
        falseAlertButton: 'Maling Alerto',
        resolveConfirmTitle: 'Lutasin ang Alerto?',
        resolveConfirmMessage: 'Sigurado ka bang gusto mong markahan ang alertong ito bilang nalutas? Ipinapalagay nito na natugunan na ang pinagbabatayan na isyu.',
        falseAlertConfirmTitle: 'Markahan bilang Maling Alerto?',
        falseAlertConfirmMessage: "Lulutasin nito ang alerto at mamarkahan ito bilang isang maling positibo. Ang aksyon na ito ay kapaki-pakinabang para sa pagpapabuti ng katumpakan ng AI model.",
        cancelButton: 'Kanselahin',
        confirmButton: 'Kumpirmahin',
        timeAgo: {
            year: '{{count}} taon na ang nakalipas',
            years: '{{count}} taon na ang nakalipas',
            month: '{{count}} buwan na ang nakalipas',
            months: '{{count}} buwan na ang nakalipas',
            day: '{{count}} araw na ang nakalipas',
            days: '{{count}} araw na ang nakalipas',
            hour: '{{count}} oras na ang nakalipas',
            hours: '{{count}} oras na ang nakalipas',
            minute: '{{count}} minuto na ang nakalipas',
            minutes: '{{count}} minuto na ang nakalipas',
            second: 'ilang segundo lang ang nakalipas',
        }
    },
    historyChart: {
        title: '24-Oras na Kasaysayan ng Sistema',
        loading: 'Nilo-load ang historical data...',
        pressureLabel: 'Presyon (PSI)',
        flowRateLabel: 'Bilis ng Daloy (L/min)',
    },
    analysisModal: {
        title: 'Pagsusuri ng Alerto na Pinapagana ng AI',
        alertDetails: 'Mga Detalye ng Alerto',
        messageLabel: 'Mensahe',
        severityLabel: 'Lala',
        sensorLabel: 'Sensor ID',
        loading: 'Isinasagawa ang pagsusuri... mangyaring maghintay.',
        summaryTitle: 'Buod ng Pagsusuri',
        causesTitle: 'Mga Posibleng Dahilan',
        actionsTitle: 'Mga Mungkahing Aksyon',
        closeButton: 'Isara',
    },
    pipelineMap: {
        title: 'Mapa ng Pipeline ng Sistema',
        editMode: 'Edit Mode',
        viewMode: 'View Mode',
        creatingPipeline: 'Pumili ng pangalawang node para kumpletuhin ang koneksyon o pindutin ang ESC para kanselahin.',
        editInstructionsPipelines: 'Mag-click ng dalawang node para gumawa ng pipeline, i-drag ang mga node para ilipat, o mag-click ng pipeline para tanggalin.',
        loading: 'Nilo-load ang data ng mapa...',
        sensorTooltipTitle: 'Sensor',
        householdTooltipTitle: 'Sambahayan',
        pumpTooltipTitle: 'Pump',
        pipelineTooltipTitle: 'Pipeline',
        statusAlert: 'May Alerto',
        statusNormal: 'Normal',
        statusLeak: 'May Tulo',
        pumpStatus: {
            Active: 'Aktibo',
            Inactive: 'Hindi Aktibo',
            Error: 'May Error',
        },
        location: 'Lokasyon',
        description: 'Deskripsyon',
        address: 'Address',
        id: 'ID',
        from: 'Mula sa',
        to: 'Pumunta sa',
        deletePipelineButton: 'Tanggalin ang Pipeline',
        addConnectionButton: 'Magdagdag ng Koneksyon',
    },
    sensorManagement: {
        title: 'Pamamahala ng Sensor',
        existingSensors: 'Mga Kasalukuyang Sensor',
        loading: 'Nilo-load ang mga sensor...',
        connectedTo: 'Nakakonekta Sa',
        noConnections: 'Walang mga koneksyon.',
        editSensorTitle: 'I-edit ang Sensor',
        addSensorTitle: 'Magdagdag ng Bagong Sensor',
        locationLabel: 'Lokasyon',
        locationPlaceholder: 'hal., Maple Ave. & Oak St.',
        descriptionLabel: 'Deskripsyon',
        descriptionPlaceholder: 'hal., Linya ng feeder sa District A',
        saveButton: 'I-save ang mga Pagbabago',
        addButton: 'Idagdag ang Sensor',
        cancelButton: 'Kanselahin',
        editButton: 'I-edit',
        deleteButton: 'Tanggalin',
        deleteConfirm: 'Sigurado ka bang gusto mong tanggalin ang sensor na ito? Ang lahat ng kaugnay na data ng pipeline ay aalisin din.',
    },
    householdManagement: {
        title: 'Pamamahala ng Sambahayan',
        existingHouseholds: 'Mga Kasalukuyang Sambahayan',
        loading: 'Nilo-load ang mga sambahayan...',
        connectedTo: 'Nakakonekta Sa',
        noConnections: 'Walang mga koneksyon.',
        editHouseholdTitle: 'I-edit ang Sambahayan',
        addHouseholdTitle: 'Magdagdag ng Bagong Sambahayan',
        addressLabel: 'Address',
        addressPlaceholder: 'hal., 123 Aqua St, Brgy. Central',
        saveButton: 'I-save ang mga Pagbabago',
        addButton: 'Idagdag ang Sambahayan',
        cancelButton: 'Kanselahin',
        editButton: 'I-edit',
        deleteButton: 'Tanggalin',
        deleteConfirm: 'Sigurado ka bang gusto mong tanggalin ang sambahayan na ito? Ang lahat ng kaugnay na data ng pipeline ay aalisin din.',
    },
    pumpManagement: {
        title: 'Pamamahala ng Pump',
        existingPumps: 'Mga Kasalukuyang Pump',
        loading: 'Nilo-load ang mga pump...',
        connectedTo: 'Nakakonekta Sa',
        noConnections: 'Walang mga koneksyon.',
        editPumpTitle: 'I-edit ang Pump',
        addPumpTitle: 'Magdagdag ng Bagong Pump',
        locationLabel: 'Lokasyon',
        locationPlaceholder: 'hal., Brgy. West Booster',
        statusLabel: 'Katayuan',
        saveButton: 'I-save ang mga Pagbabago',
        addButton: 'Idagdag ang Pump',
        cancelButton: 'Kanselahin',
        editButton: 'I-edit',
        deleteButton: 'Tanggalin',
        deleteConfirm: 'Sigurado ka bang gusto mong tanggalin ang pump na ito? Ang lahat ng kaugnay na data ng pipeline ay aalisin din.',
    },
    userManagement: {
        title: 'Pamamahala ng User',
        existingUsers: 'Mga Kasalukuyang User',
        loading: 'Nilo-load ang mga user...',
        editUserTitle: 'I-edit ang User',
        addUserTitle: 'Magdagdag ng Bagong User',
        nameLabel: 'Buong Pangalan',
        namePlaceholder: 'hal., Juan dela Cruz',
        emailLabel: 'Email Address',
        emailPlaceholder: 'e.g., user@example.com',
        roleLabel: 'Tungkulin',
        saveButton: 'I-save ang mga Pagbabago',
        addButton: 'Idagdag ang User',
        cancelButton: 'Kanselahin',
        editButton: 'I-edit',
        deleteButton: 'Tanggalin',
        deleteConfirm: 'Sigurado ka bang gusto mong alisin ang user na ito?',
    },
    forum: {
        title: 'Forum ng Komunidad',
        announcements: 'Mga Anunsyo',
        communityHub: 'Sentro ng Komunidad',
        adminDiscussions: 'Usapan ng mga Admin',
        newTopic: 'Bagong Paksa',
        editTopic: 'I-edit ang Paksa', // ✅ Added
        by: 'Ni',
        noTopics: 'Wala pang mga paksa sa kategoryang ito.',
        loadingTopics: 'Nilo-load ang mga paksa...',
        loadingTopic: 'Nilo-load ang paksa...',
        backToTopics: 'Bumalik sa mga Paksa',
        topicTitle: 'Pamagat ng Paksa',
        yourMessage: 'Ang Iyong Mensahe',
        createTopic: 'Gumawa ng Paksa',
        saveChanges: 'I-save ang Pagbabago', // ✅ Added
        cancel: 'Kanselahin',
        yourReply: 'Ang iyong tugon...',
        postReply: 'I-post ang Tugon',
        confirmDelete: 'Sigurado ka bang gusto mong tanggalin ang paksang ito?', // ✅ Added
        general: 'Pangkalahatan',
        alerts: 'Mga Alerto',
        maintenance: 'Pagpapanatili'
    },
    mlTraining: {
        title: 'Machine Learning Model',
        status: 'Katayuan ng Modelo',
        statusNotTrained: 'Hindi Pa Nasasanay',
        statusTraining: 'Nagsasanay',
        statusTrained: 'Nasanay na',
        lastTrained: 'Huling Nasanay',
        notTrained: 'N/A',
        startTrainingButton: 'Simulan ang Pagsasanay',
        trainingInProgressButton: 'Kasalukuyang Nagsasanay...',
        
        // ✅ ADDED MISSING KEYS for Filipino translation
        trainingButton: 'Nagsasanay...', 
        trainingButtonLoading: 'Pinoproseso...',
        trainingInProgress: 'Kasalukuyang Nagsasanay...',
        currentVersion: 'Kasalukuyang Bersyon',
        nextTraining: 'Susunod na Pagsasanay',
        
        trainingLogTitle: 'Log ng Pagsasanay',
        resultsTitle: 'Mga Resulta ng Pagsasanay',
        accuracy: 'Katumpakan ng Modelo',
        confusionMatrixTitle: 'Confusion Matrix',
        predicted: 'Hinulaan',
        actual: 'Aktwal',
        leak: 'May Tulo',
        noLeak: 'Walang Tulo',
        logs: {
            start: 'Sinimulan ang proseso ng pagsasanay...',
            loadData: 'Nilo-load ang historical sensor at alert data...',
            preprocess: 'Pinoproseso ang data: paglilinis at normalisasyon...',
            featureSelection: 'Isinasagawa ang pagpili ng feature...',
            training: 'Sinasanay ang modelo gamit ang naprosesong data (maaaring tumagal ito)...',
            evaluating: 'Sinusuri ang performance ng modelo...',
            complete: 'Kumpleto na ang pagsasanay!',
        }
    },
    logViewer: {
        title: 'Mga Log ng Aktibidad ng Sistema',
        searchPlaceholder: 'Maghanap ng mga log ayon sa aksyon, detalye, o user...',
        loading: 'Nilo-load ang mga log...',
        noLogs: 'Walang nakitang log na tumutugma sa iyong criteria.',
        logEntry: 'Log Entry',
        logEntries: 'Mga Log Entry',
        header: {
            timestamp: 'Timestamp',
            action: 'Aksyon',
            details: 'Mga Detalye',
        },
    },
  },
};

type Language = 'en' | 'fil';
type Translations = typeof translations;

// 2. Create a Context
interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string, options?: { [key: string]: string | number }) => string;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

// Interpolation function to replace placeholders like {{name}}
const interpolate = (str: string, options?: { [key: string]: string | number }) => {
  if (!options) return str;
  return Object.entries(options).reduce((acc, [key, value]) => {
    return acc.replace(`{{${key}}}`, String(value));
  }, str);
};

// Function to get a nested property from an object using a dot-separated string
const getNestedTranslation = (obj: any, key: string): string | undefined => {
  return key.split('.').reduce((acc, part) => acc && acc[part], obj);
};

// 3. Create a Provider Component
export const LanguageProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<Language>('en');

  const t = (key: string, options?: { [key: string]: string | number }) => {
    const translation = getNestedTranslation(translations[language], key);
    if (translation) {
      return interpolate(translation, options);
    }
    // Fallback to English if translation is not found
    const fallback = getNestedTranslation(translations.en, key);
    if (fallback) {
      return interpolate(fallback, options);
    }
    return key; // Return the key if no translation is found anywhere
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
};

// 4. Create a custom hook for easy access
export const useTranslation = () => {
  const context = useContext(LanguageContext);
  if (context === undefined) {
    throw new Error('useTranslation must be used within a LanguageProvider');
  }
  return context;
};